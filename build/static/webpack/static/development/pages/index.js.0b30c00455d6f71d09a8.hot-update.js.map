{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.0b30c00455d6f71d09a8.hot-update.js","sources":["webpack:///./components/utils/SubmitButton.js"],"sourcesContent":["import { useState, useContext } from \"react\";\r\nimport { ShowAlertContext } from \"../../pages/_app\";\r\nimport { RegisterModalHandler } from \"../Home/Main\";\r\nimport { LoginModalHandler } from \"../Home/Main\";\r\nimport checkFieldsValidity from \"../../utils/checkFieldsValidity\";\r\n\r\nexport default function SubmitButton({ userData, showErrorMessage, buttonTitle, type }) {\r\n    const [isDisabled, setDisabled] = useState(false);\r\n\r\n    const showModalHandler = useContext(\r\n        type === \"register\" ? RegisterModalHandler : LoginModalHandler\r\n    );\r\n    const modifyAlert = useContext(ShowAlertContext);\r\n\r\n    return (\r\n        <>\r\n            <button\r\n                type=\"submit\"\r\n                disabled={isDisabled}\r\n                onClick={(e) =>\r\n                    submitHandler({\r\n                        e,\r\n                        userData,\r\n                        showErrorMessage,\r\n                        setDisabled,\r\n                        modalHandler: showModalHandler,\r\n                        modifyAlert,\r\n                        fetchEndpoint: `api/${type}`,\r\n                    })\r\n                }\r\n                className=\"button--primary\"\r\n            >\r\n                {buttonTitle}\r\n            </button>\r\n            <style jsx>{`\r\n                .button--primary {\r\n                    background-color: var(--accent-secondary);\r\n                }\r\n            `}</style>\r\n        </>\r\n    );\r\n}\r\n\r\nfunction submitHandler({\r\n    e,\r\n    userData,\r\n    showErrorMessage,\r\n    setDisabled,\r\n    modalHandler,\r\n    modifyAlert,\r\n    fetchEndpoint,\r\n}) {\r\n    e.preventDefault();\r\n    setDisabled(true);\r\n\r\n    const errorMessage = checkFieldsValidity({\r\n        fields: userData,\r\n        minimumLengthForEachField: {\r\n            name: 3,\r\n            surname: 3,\r\n            username: 5,\r\n            password: 8,\r\n        },\r\n        hasEmail: true,\r\n    });\r\n\r\n    if (errorMessage !== false) {\r\n        setDisabled(false);\r\n        return showErrorMessage(errorMessage);\r\n    }\r\n\r\n    fetch(fetchEndpoint, {\r\n        method: \"POST\",\r\n        body: JSON.stringify(userData),\r\n    })\r\n        .then((r) => r.json())\r\n        .then(({ ok, error = null }) => {\r\n            if (!ok)\r\n                modifyAlert({\r\n                    isVisible: true,\r\n                    props: {\r\n                        type: 0,\r\n                        children: !error\r\n                            ? \"A apărut o eroare internă, vă rugam să ne scuzați.\"\r\n                            : error,\r\n                    },\r\n                });\r\n            else\r\n                modifyAlert({\r\n                    isVisible: true,\r\n                    props: {\r\n                        type: 1,\r\n                        children: \"Operațiunea a fost efectuată cu succes.\",\r\n                    },\r\n                });\r\n\r\n            modalHandler();\r\n        })\r\n        .catch((error) => {\r\n            console.error(error);\r\n            setDisabled(false);\r\n            showErrorMessage(\"A aparut o eroare interna, va rog sa ne scuzati.\");\r\n        });\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAEA;AAGA;AAEA;AAGA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AADA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AA0BA;AACA;AACA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AARA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAFA;AAFA;AAWA;AACA;AACA;AACA;AAFA;AAFA;AAQA;AACA;AAEA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}